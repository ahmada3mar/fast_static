import{_ as D}from"./CkDK5K5s.js";import{g as ae,N as ne,H as N,r as E,l as g,m as te,i as z,_ as U,j as Y,k as W,A as le,e as R,p as ie,q as w,o as j,c as O,a as re,y as ue,v as $,n as S,b as J,x as k,D as oe,K as se,M as ce,O as de,I as fe,f as ve,J as A,P as ge}from"./4LX62bhM.js";import{i as me,u as ye,b as be}from"./C_P8Dj8h.js";function p(e){return typeof e=="function"?e():ae(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const q=()=>{};function he(e,l){function r(...a){return new Promise((n,i)=>{Promise.resolve(e(()=>l.apply(this,a),{fn:l,thisArg:this,args:a})).then(n).catch(i)})}return r}function Ie(e,l={}){let r,a,n=q;const i=u=>{clearTimeout(u),n(),n=q};return u=>{const s=p(e),d=p(l.maxWait);return r&&i(r),s<=0||d!==void 0&&d<=0?(a&&(i(a),a=null),Promise.resolve(u())):new Promise((t,o)=>{n=l.rejectOnCancel?o:t,d&&!a&&(a=setTimeout(()=>{r&&i(r),a=null,t(u())},d)),r=setTimeout(()=>{a&&i(a),a=null,t(u())},s)})}}function we(e,l=200,r={}){return he(Ie(l,r),e)}const C=new Map;function Se(e){const l=ne();function r(u){var s;const d=C.get(e)||new Set;d.add(u),C.set(e,d);const t=()=>n(u);return(s=l==null?void 0:l.cleanups)==null||s.push(t),t}function a(u){function s(...d){n(s),u(...d)}return r(s)}function n(u){const s=C.get(e);s&&(s.delete(u),s.size||i())}function i(){C.delete(e)}function f(u,s){var d;(d=C.get(e))==null||d.forEach(t=>t(u,s))}return{on:r,once:a,off:n,emit:f,reset:i}}const Ce=(e,l,r=!0)=>{const a=N("form-events",void 0),n=N("form-group",void 0),i=N("form-inputs",void 0);n&&(!r||e!=null&&e.legend?n.inputId.value=void 0:e!=null&&e.id&&(n.inputId.value=e==null?void 0:e.id),i&&(i.value[n.name.value]=n.inputId.value));const f=E(!1);function u(o,v){a&&a.emit({type:o,path:v})}function s(){u("blur",n==null?void 0:n.name.value),f.value=!0}function d(){u("change",n==null?void 0:n.name.value)}const t=we(()=>{(f.value||n!=null&&n.eagerValidation.value)&&u("input",n==null?void 0:n.name.value)},300);return{inputId:g(()=>(e==null?void 0:e.id)??(n==null?void 0:n.inputId.value)),name:g(()=>(e==null?void 0:e.name)??(n==null?void 0:n.name.value)),size:g(()=>{var v;const o=l.size[n==null?void 0:n.size.value]?n==null?void 0:n.size.value:null;return(e==null?void 0:e.size)??o??((v=l.default)==null?void 0:v.size)}),color:g(()=>{var o;return(o=n==null?void 0:n.error)!=null&&o.value?"red":e==null?void 0:e.color}),emitFormBlur:s,emitFormInput:t,emitFormChange:d}},h=te(z.ui.strategy,z.ui.input,me),ze=Y({components:{UIcon:D},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>h.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(h.size).includes(e)}},color:{type:String,default:()=>h.default.color,validator(e){return[...z.ui.colors,...Object.keys(h.color)].includes(e)}},variant:{type:String,default:()=>h.default.variant,validator(e){return[...Object.keys(h.variant),...Object.values(h.color).flatMap(l=>Object.keys(l))].includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l,slots:r}){const{ui:a,attrs:n}=ye("input",W(e,"ui"),h,W(e,"class")),{size:i,rounded:f}=be({ui:a,props:e}),{emitFormBlur:u,emitFormInput:s,size:d,color:t,inputId:o,name:v}=Ce(e,h),m=g(()=>i.value??d.value),y=E(le({},e.modelModifiers,{trim:!1,lazy:!1,number:!1})),b=E(null),L=()=>{var c;e.autofocus&&((c=b.value)==null||c.focus())},V=c=>{y.value.trim&&(c=c.trim()),(y.value.number||e.type==="number")&&(c=oe(c)),l("update:modelValue",c),s()},Z=c=>{y.value.lazy||V(c.target.value)},H=c=>{if(e.type==="file"){const I=c.target.files;l("change",I)}else{const I=c.target.value;l("change",I),y.value.lazy&&V(I),y.value.trim&&(c.target.value=I.trim())}},K=c=>{u(),l("blur",c)};R(()=>{setTimeout(()=>{L()},e.autofocusDelay)});const Q=g(()=>{var I,M;const c=((M=(I=a.value.color)==null?void 0:I[t.value])==null?void 0:M[e.variant])||a.value.variant[e.variant];return ie(w(a.value.base,a.value.form,f.value,a.value.placeholder,e.type==="file"&&a.value.file.base,a.value.size[m.value],e.padded?a.value.padding[m.value]:"p-0",c==null?void 0:c.replaceAll("{color}",t.value),(B.value||r.leading)&&a.value.leading.padding[m.value],(T.value||r.trailing)&&a.value.trailing.padding[m.value]),e.inputClass)}),B=g(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),T=g(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),X=g(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),_=g(()=>e.loading&&!B.value?e.loadingIcon:e.trailingIcon||e.icon),G=g(()=>w(a.value.icon.leading.wrapper,a.value.icon.leading.pointer,a.value.icon.leading.padding[m.value])),P=g(()=>w(a.value.icon.base,t.value&&z.ui.colors.includes(t.value)&&a.value.icon.color.replaceAll("{color}",t.value),a.value.icon.size[m.value],e.loading&&a.value.icon.loading)),x=g(()=>w(a.value.icon.trailing.wrapper,a.value.icon.trailing.pointer,a.value.icon.trailing.padding[m.value])),ee=g(()=>w(a.value.icon.base,t.value&&z.ui.colors.includes(t.value)&&a.value.icon.color.replaceAll("{color}",t.value),a.value.icon.size[m.value],e.loading&&!B.value&&a.value.icon.loading));return{ui:a,attrs:n,name:v,inputId:o,input:b,isLeading:B,isTrailing:T,inputClass:Q,leadingIconName:X,leadingIconClass:P,leadingWrapperIconClass:G,trailingIconName:_,trailingIconClass:ee,trailingWrapperIconClass:x,onInput:Z,onChange:H,onBlur:K}}}),Ee=["id","name","type","required","placeholder","disabled"];function Be(e,l,r,a,n,i){const f=D;return j(),O("div",{class:S(e.type==="hidden"?"hidden":e.ui.wrapper)},[re("input",ue({id:e.inputId,ref:"input",name:e.name,type:e.type,required:e.required,placeholder:e.placeholder,disabled:e.disabled,class:e.inputClass},e.type==="file"?e.attrs:{...e.attrs,value:e.modelValue},{onInput:l[0]||(l[0]=(...u)=>e.onInput&&e.onInput(...u)),onBlur:l[1]||(l[1]=(...u)=>e.onBlur&&e.onBlur(...u)),onChange:l[2]||(l[2]=(...u)=>e.onChange&&e.onChange(...u))}),null,16,Ee),$(e.$slots,"default"),e.isLeading&&e.leadingIconName||e.$slots.leading?(j(),O("span",{key:0,class:S(e.leadingWrapperIconClass)},[$(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[J(f,{name:e.leadingIconName,class:S(e.leadingIconClass)},null,8,["name","class"])])],2)):k("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(j(),O("span",{key:1,class:S(e.trailingWrapperIconClass)},[$(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[J(f,{name:e.trailingIconName,class:S(e.trailingIconClass)},null,8,["name","class"])])],2)):k("",!0)],2)}const Ue=U(ze,[["render",Be]]);class F extends Error{constructor(l){super(l),this.message=l,Object.setPrototypeOf(this,F.prototype)}}const je=Y({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:l,emit:r}){const a=fe(),n=Se(`form-${a}`);R(()=>{n.on(async t=>{var o;t.type!=="submit"&&((o=e.validateOn)!=null&&o.includes(t.type))&&await s(t.path,{silent:!0})})}),ve(()=>{n.reset()});const i=E([]);A("form-errors",i),A("form-events",n);const f=E({});A("form-inputs",f);async function u(){let t=await e.validate(e.state);if(e.schema)if(Ne(e.schema))t=t.concat(await Ae(e.state,e.schema));else if(Oe(e.schema))t=t.concat(await Fe(e.state,e.schema));else if(Ve(e.schema))t=t.concat(await Me(e.state,e.schema));else if(We(e.schema))t=t.concat(await Je(e.state,e.schema));else throw new Error("Form validation failed: Unsupported form schema");return t}async function s(t,o={silent:!1}){let v=t;if(t&&!Array.isArray(t)&&(v=[t]),v){const m=i.value.filter(b=>!v.includes(b.path)),y=(await u()).filter(b=>v.includes(b.path));i.value=m.concat(y)}else i.value=await u();if(i.value.length>0){if(o.silent)return!1;throw new F(`Form validation failed: ${JSON.stringify(i.value,null,2)}`)}return e.state}async function d(t){var v;const o=t;try{(v=e.validateOn)!=null&&v.includes("submit")&&await s(),o.data=e.state,r("submit",o)}catch(m){if(!(m instanceof F))throw m;const y={...o,errors:i.value.map(b=>({...b,id:f.value[b.path]}))};r("error",y)}}return l({validate:s,errors:i,setErrors(t,o){o?i.value=i.value.filter(v=>v.path!==o).concat(t):i.value=t},async submit(){await d(new Event("submit"))},getErrors(t){return t?i.value.filter(o=>o.path===t):i.value},clear(t){t?i.value=i.value.filter(o=>o.path!==t):i.value=[]}}),{onSubmit:d,errors:ge(i)}}});function Oe(e){return e.validate&&e.__isYupSchema__}function $e(e){return e.inner!==void 0}async function Fe(e,l){try{return await l.validate(e,{abortEarly:!1}),[]}catch(r){if($e(r))return r.inner.map(a=>({path:a.path??"",message:a.message}));throw r}}function Ne(e){return e.parse!==void 0}async function Ae(e,l){const r=await l.safeParseAsync(e);return r.success===!1?r.error.issues.map(a=>({path:a.path.join("."),message:a.message})):[]}function Ve(e){return e.validateAsync!==void 0&&e.id!==void 0}function Te(e){return e.isJoi===!0}async function Me(e,l){try{return await l.validateAsync(e,{abortEarly:!1}),[]}catch(r){if(Te(r))return r.details.map(a=>({path:a.path.join("."),message:a.message}));throw r}}function We(e){return"_parse"in e||"_run"in e||typeof e=="function"&&"schema"in e}async function Je(e,l){var a;return((a=(await("_parse"in l?l._parse(e):"_run"in l?l._run({typed:!1,value:e},{}):l(e))).issues)==null?void 0:a.map(n=>{var i;return{path:((i=n.path)==null?void 0:i.map(f=>f.key).join("."))||"",message:n.message}}))||[]}function ke(e,l,r,a,n,i){return j(),O("form",{onSubmit:l[0]||(l[0]=de((...f)=>e.onSubmit&&e.onSubmit(...f),["prevent"]))},[$(e.$slots,"default",se(ce({errors:e.errors})))],32)}const Ye=U(je,[["render",ke]]);export{Ue as _,Ye as a,Ce as u};
