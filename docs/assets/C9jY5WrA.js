import{i as P,_ as U,u as x}from"./C6FJ-RXg.js";import{I as F,r as C,N as ee,l as f,m as ae,i as z,_ as D,j as T,k as M,D as ne,e as W,q as te,s as w,o as E,c as $,a as le,z as ie,x as j,n as S,b as J,y as q,H as ue,L as re,M as se,O as oe,J as de,f as ce,K as N,P as fe}from"./Ct3Dgylx.js";import{u as ve}from"./D9kve4Z0.js";import{u as ge}from"./BXXmQ1sG.js";const me=(e,l,r=!0)=>{const a=F("form-events",void 0),n=F("form-group",void 0),i=F("form-inputs",void 0);n&&(!r||e!=null&&e.legend?n.inputId.value=void 0:e!=null&&e.id&&(n.inputId.value=e==null?void 0:e.id),i&&(i.value[n.name.value]=n.inputId.value));const d=C(!1);function c(u,o){a&&a.emit({type:u,path:o})}function I(){c("blur",n==null?void 0:n.name.value),d.value=!0}function h(){c("change",n==null?void 0:n.name.value)}const t=ee(()=>{(d.value||n!=null&&n.eagerValidation.value)&&c("input",n==null?void 0:n.name.value)},300);return{inputId:f(()=>(e==null?void 0:e.id)??(n==null?void 0:n.inputId.value)),name:f(()=>(e==null?void 0:e.name)??(n==null?void 0:n.name.value)),size:f(()=>{var o;const u=l.size[n==null?void 0:n.size.value]?n==null?void 0:n.size.value:null;return(e==null?void 0:e.size)??u??((o=l.default)==null?void 0:o.size)}),color:f(()=>{var u;return(u=n==null?void 0:n.error)!=null&&u.value?"red":e==null?void 0:e.color}),emitFormBlur:I,emitFormInput:t,emitFormChange:h}},y=ae(z.ui.strategy,z.ui.input,P),ye=T({components:{UIcon:U},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>y.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(y.size).includes(e)}},color:{type:String,default:()=>y.default.color,validator(e){return[...z.ui.colors,...Object.keys(y.color)].includes(e)}},variant:{type:String,default:()=>y.default.variant,validator(e){return[...Object.keys(y.variant),...Object.values(y.color).flatMap(l=>Object.keys(l))].includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l,slots:r}){const{ui:a,attrs:n}=x("input",M(e,"ui"),y,M(e,"class")),{size:i,rounded:d}=ve({ui:a,props:e}),{emitFormBlur:c,emitFormInput:I,size:h,color:t,inputId:u,name:o}=me(e,y),v=f(()=>i.value??h.value),g=C(ne({},e.modelModifiers,{trim:!1,lazy:!1,number:!1})),m=C(null),Y=()=>{var s;e.autofocus&&((s=m.value)==null||s.focus())},A=s=>{g.value.trim&&(s=s.trim()),(g.value.number||e.type==="number")&&(s=ue(s)),l("update:modelValue",s),I()},L=s=>{g.value.lazy||A(s.target.value)},R=s=>{if(e.type==="file"){const b=s.target.files;l("change",b)}else{const b=s.target.value;l("change",b),g.value.lazy&&A(b),g.value.trim&&(s.target.value=b.trim())}},Z=s=>{c(),l("blur",s)};W(()=>{setTimeout(()=>{Y()},e.autofocusDelay)});const H=f(()=>{var b,V;const s=((V=(b=a.value.color)==null?void 0:b[t.value])==null?void 0:V[e.variant])||a.value.variant[e.variant];return te(w(a.value.base,a.value.form,d.value,a.value.placeholder,e.type==="file"&&a.value.file.base,a.value.size[v.value],e.padded?a.value.padding[v.value]:"p-0",s==null?void 0:s.replaceAll("{color}",t.value),(B.value||r.leading)&&a.value.leading.padding[v.value],(k.value||r.trailing)&&a.value.trailing.padding[v.value]),e.inputClass)}),B=f(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),k=f(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),K=f(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),Q=f(()=>e.loading&&!B.value?e.loadingIcon:e.trailingIcon||e.icon),X=f(()=>w(a.value.icon.leading.wrapper,a.value.icon.leading.pointer,a.value.icon.leading.padding[v.value])),_=f(()=>w(a.value.icon.base,t.value&&z.ui.colors.includes(t.value)&&a.value.icon.color.replaceAll("{color}",t.value),a.value.icon.size[v.value],e.loading&&a.value.icon.loading)),p=f(()=>w(a.value.icon.trailing.wrapper,a.value.icon.trailing.pointer,a.value.icon.trailing.padding[v.value])),G=f(()=>w(a.value.icon.base,t.value&&z.ui.colors.includes(t.value)&&a.value.icon.color.replaceAll("{color}",t.value),a.value.icon.size[v.value],e.loading&&!B.value&&a.value.icon.loading));return{ui:a,attrs:n,name:o,inputId:u,input:m,isLeading:B,isTrailing:k,inputClass:H,leadingIconName:K,leadingIconClass:_,leadingWrapperIconClass:X,trailingIconName:Q,trailingIconClass:G,trailingWrapperIconClass:p,onInput:L,onChange:R,onBlur:Z}}}),be=["id","name","type","required","placeholder","disabled"];function Ie(e,l,r,a,n,i){const d=U;return E(),$("div",{class:S(e.type==="hidden"?"hidden":e.ui.wrapper)},[le("input",ie({id:e.inputId,ref:"input",name:e.name,type:e.type,required:e.required,placeholder:e.placeholder,disabled:e.disabled,class:e.inputClass},e.type==="file"?e.attrs:{...e.attrs,value:e.modelValue},{onInput:l[0]||(l[0]=(...c)=>e.onInput&&e.onInput(...c)),onBlur:l[1]||(l[1]=(...c)=>e.onBlur&&e.onBlur(...c)),onChange:l[2]||(l[2]=(...c)=>e.onChange&&e.onChange(...c))}),null,16,be),j(e.$slots,"default"),e.isLeading&&e.leadingIconName||e.$slots.leading?(E(),$("span",{key:0,class:S(e.leadingWrapperIconClass)},[j(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[J(d,{name:e.leadingIconName,class:S(e.leadingIconClass)},null,8,["name","class"])])],2)):q("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(E(),$("span",{key:1,class:S(e.trailingWrapperIconClass)},[j(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[J(d,{name:e.trailingIconName,class:S(e.trailingIconClass)},null,8,["name","class"])])],2)):q("",!0)],2)}const Je=D(ye,[["render",Ie]]);class O extends Error{constructor(l){super(l),this.message=l,Object.setPrototypeOf(this,O.prototype)}}const he=T({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:l,emit:r}){const a=de(),n=ge(`form-${a}`);W(()=>{n.on(async t=>{var u;t.type!=="submit"&&((u=e.validateOn)!=null&&u.includes(t.type))&&await I(t.path,{silent:!0})})}),ce(()=>{n.reset()});const i=C([]);N("form-errors",i),N("form-events",n);const d=C({});N("form-inputs",d);async function c(){let t=await e.validate(e.state);if(e.schema)if(Ce(e.schema))t=t.concat(await Be(e.state,e.schema));else if(we(e.schema))t=t.concat(await ze(e.state,e.schema));else if(Ee(e.schema))t=t.concat(await je(e.state,e.schema));else if(Oe(e.schema))t=t.concat(await Fe(e.state,e.schema));else throw new Error("Form validation failed: Unsupported form schema");return t}async function I(t,u={silent:!1}){let o=t;if(t&&!Array.isArray(t)&&(o=[t]),o){const v=i.value.filter(m=>!o.includes(m.path)),g=(await c()).filter(m=>o.includes(m.path));i.value=v.concat(g)}else i.value=await c();if(i.value.length>0){if(u.silent)return!1;throw new O(`Form validation failed: ${JSON.stringify(i.value,null,2)}`)}return e.state}async function h(t){var o;const u=t;try{(o=e.validateOn)!=null&&o.includes("submit")&&await I(),u.data=e.state,r("submit",u)}catch(v){if(!(v instanceof O))throw v;const g={...u,errors:i.value.map(m=>({...m,id:d.value[m.path]}))};r("error",g)}}return l({validate:I,errors:i,setErrors(t,u){u?i.value=i.value.filter(o=>o.path!==u).concat(t):i.value=t},async submit(){await h(new Event("submit"))},getErrors(t){return t?i.value.filter(u=>u.path===t):i.value},clear(t){t?i.value=i.value.filter(u=>u.path!==t):i.value=[]}}),{onSubmit:h,errors:fe(i)}}});function we(e){return e.validate&&e.__isYupSchema__}function Se(e){return e.inner!==void 0}async function ze(e,l){try{return await l.validate(e,{abortEarly:!1}),[]}catch(r){if(Se(r))return r.inner.map(a=>({path:a.path??"",message:a.message}));throw r}}function Ce(e){return e.parse!==void 0}async function Be(e,l){const r=await l.safeParseAsync(e);return r.success===!1?r.error.issues.map(a=>({path:a.path.join("."),message:a.message})):[]}function Ee(e){return e.validateAsync!==void 0&&e.id!==void 0}function $e(e){return e.isJoi===!0}async function je(e,l){try{return await l.validateAsync(e,{abortEarly:!1}),[]}catch(r){if($e(r))return r.details.map(a=>({path:a.path.join("."),message:a.message}));throw r}}function Oe(e){return"_parse"in e||"_run"in e||typeof e=="function"&&"schema"in e}async function Fe(e,l){var a;return((a=(await("_parse"in l?l._parse(e):"_run"in l?l._run({typed:!1,value:e},{}):l(e))).issues)==null?void 0:a.map(n=>{var i;return{path:((i=n.path)==null?void 0:i.map(d=>d.key).join("."))||"",message:n.message}}))||[]}function Ne(e,l,r,a,n,i){return E(),$("form",{onSubmit:l[0]||(l[0]=oe((...d)=>e.onSubmit&&e.onSubmit(...d),["prevent"]))},[j(e.$slots,"default",re(se({errors:e.errors})))],32)}const qe=D(he,[["render",Ne]]);export{qe as _,Je as a,me as u};
